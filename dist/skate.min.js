!function(){"use strict";function a(a,b){return{addedNodes:null,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:null,target:a,type:b||"childList"}}function b(a,c){if(c=o(c||{},b.defaults),c.id=a,p(I,c.id))throw new Error('A component of type "'+c.type+'" with the ID of "'+a+'" already exists.');return c.template&&"string"==typeof c.template&&(c.template=b.template.html(c.template)),(c.ready||c.template)&&G.sheet.insertRule(t(a,c.type,"."+c.classname)+"{display:none}",G.sheet.cssRules.length),I[c.id]=c,L(),B(),c.type.indexOf(b.types.TAG)>-1?r(a,c):void 0}function c(a,b){d(a,b,function(){k(a,b.id+".ready-done",!0),e(a,b)})}function d(a,b,c){var d=/^[^(]+\([^,)]+,/;return c=c||function(){},j(a,b.id+".ready-started")?c():(k(a,b.id+".ready-started",!0),b.template&&b.template(a),o(a,b.prototype),h(a,b),void(b.ready&&d.test(b.ready)?b.ready(a,c):b.ready?(b.ready(a),c()):c()))}function e(a,b){a.parentNode&&j(a,b.id+".ready-done")&&(j(a,b.id+".insert-started")||(k(a,b.id+".insert-started",!0),l(a,b.classname),b.insert&&b.insert(a),g(a,b)))}function f(a,b){j(a,b.id+".remove-called")||(k(a,b.id+".remove-called",!0),b.remove&&b.remove(a))}function g(a,b){function c(c,d,e,f){var g;b.attributes&&b.attributes[d]&&"function"==typeof b.attributes[d][c]?g=b.attributes[d][c]:b.attributes&&"function"==typeof b.attributes[d]?g=b.attributes[d]:"function"==typeof b.attributes&&(g=b.attributes),g&&g(a,{type:c,name:d,newValue:e,oldValue:f})}if(b.attributes&&!j(a,b.id+".attributes-called")){k(a,b.id+".attributes-called",!0);var d=a.attributes,e=d.length,f=new K(function(a){a.forEach(function(a){var b,e=a.attributeName,f=d[e];f&&null===a.oldValue?b="insert":f&&null!==a.oldValue?b="update":f||(b="remove"),c(b,e,f?f.nodeValue:void 0,a.oldValue)})});f.observe(a,{attributes:!0,attributeOldValue:!0});for(var g=0;e>g;g++){var h=d[g];c("insert",h.nodeName,h.nodeValue)}}}function h(a,b){function c(b,c){return function(d){(!c||n(d.target,c))&&b(a,d)}}"object"==typeof b.events&&q(b.events,function(b,d){var e=i(d);a.addEventListener(e.name,c(b,e.delegate))})}function i(a){var b=a.split(" ");return{name:b.shift(),delegate:b.join(" ")}}function j(a,b){return a.__SKATE_DATA?a.__SKATE_DATA[b]:void 0}function k(a,b,c){a.__SKATE_DATA||(a.__SKATE_DATA={}),a.__SKATE_DATA[b]=c}function l(a,b){a.classList?a.classList.add(b):a.className+=a.className?" "+b:b}function m(a){var b=a.classList;if(b)return b;var c=a.attributes;return c["class"]&&c["class"].nodeValue.split(/\s+/)||[]}function n(a,b){return(a.matches||a.msMatchesSelector||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector).call(a,b)}function o(a,b){return q(b,function(b,c){void 0===a[c]&&(a[c]=b)}),a}function p(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function q(a,b){for(var c in a)p(a,c)&&b(a[c],c)}function r(a,b){function c(){var e=document.createElement(a);return b.prototype=c.prototype,d(e,b),e}return c.prototype=b.prototype,c}function s(a){for(var b=a;b&&b!==document;){if(b.hasAttribute(F))return b;b=b.parentNode}}function t(a,c,d){var e=c.indexOf(b.types.TAG)>-1,f=c.indexOf(b.types.ATTR)>-1,g=c.indexOf(b.types.CLASS)>-1,h=[];return d&&(d=":not("+d+")"),e&&(h.push(a+d),h.push("[is="+a+"]"+d)),f&&h.push("["+a+"]"+d),g&&h.push("."+a+d),h.join(",")}function u(a,b){return p(I,a)&&I[a].type.indexOf(b)>-1}function v(a,b){var c=b?a.querySelectorAll(b):a.childNodes;return[].filter.call(c,function(b){return b.parentNode===a})}function w(a){var b={caption:"table",dd:"dl",dt:"dl",li:"ul",tbody:"table",td:"tr",thead:"table",tr:"tbody"},c=a.match(/\s*<([^\s>]+)/),d=document.createDocumentFragment(),e=document.createElement(c&&b[c[1]]||"div");return e.innerHTML=a,x(d,e.childNodes),d}function x(a,b){var c=b.length;if(b&&c)for(var d=c-1;d>=0;d--){var e=b[d],f=a.childNodes[0];f?a.insertBefore(e,f):a.appendChild(e)}}function y(a){for(var c=a.length,d=0;c>d;d++){var e=a[d];1===e.nodeType&&b.init(e)}}function z(a){for(var c=a.length,d=0;c>d;d++){var e=a[d];if(1===e.nodeType){var f=e.childNodes;z(f),b.components(e).forEach(A(e))}}}function A(a){return function(b){f(a,b)}}function B(){D||(D=new K(function(a){H=!0,a.forEach(function(a){a.addedNodes&&(s(a.addedNodes[0].parentNode)||y(a.addedNodes)),a.removedNodes&&z(a.removedNodes)})}),D.observe(document,{childList:!0,subtree:!0}))}function C(a){var b;return function(){clearTimeout(b),b=setTimeout(a,1)}}var D,E="data-skate-content",F="data-skate-ignore",G=document.createElement("style"),H=!0,I={},J=function(){this.map=[]};J.prototype={clear:function(){return this.map=[],this},get:function(a){var b=this.index(a);return b>-1?this.map[b]:void 0},index:function(a){var b=j(a,"element-map-index");return b>-1?b:-1},items:function(){return this.map},set:function(a,b){var c=this.index(a);return c>-1?this.map[c]=b:(k(a,"element-map-index",this.map.length),this.map.push(b)),this}};var K=window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver;K||(K=function(a){this.callback=a,this.elements=[]},K.prototype={observe:function(b,c){function d(a){return c.childList&&(c.subtree||a.target.parentNode===b)}function e(a){return a.target===b}var f,g,h=C(function(){j.callback(l.items()),l.clear(),f=void 0,g=void 0}),i=C(function(){var a=m.length;j.callback(m),m.splice(0,a)}),j=this,k={},l=new J,m=[],n={target:b,options:c,insertHandler:function(b){if(d(b)&&(!f||!f.contains(b.target))){var c=b.target.parentNode,e=l.get(c);e?(e.addedNodes||(e.addedNodes=[]),e.addedNodes.push(b.target)):(e=a(c),e.addedNodes=[],e.addedNodes.push(b.target),l.set(c,e)),f=c,h()}},removeHandler:function(b){if(d(b)&&(!g||!g.contains(b.target))){var c=b.target.parentNode,e=l.get(c);e?(e.removedNodes||(e.removedNodes=[]),e.removedNodes.push(b.target)):(e=a(c),e.removedNodes=[],e.removedNodes.push(b.target),l.set(c,e)),g=b.target,h()}},attributeHandler:function(b){if(e(b)){var d=a(b.target,"attributes");d.attributeName=b.attrName,c.attributeOldValue&&(d.oldValue=k[b.attrName]||b.prevValue||null),m.push(d),c.attributeOldValue&&(k[b.attrName]=b.newValue),i()}}};return this.elements.push(n),c.childList&&(b.addEventListener("DOMNodeInserted",n.insertHandler),b.addEventListener("DOMNodeRemoved",n.removeHandler)),c.attributes&&b.addEventListener("DOMAttrModified",n.attributeHandler),this},disconnect:function(){return q(this.elements,function(a){a.target.removeEventListener("DOMSubtreeModified",a.insertHandler),a.target.removeEventListener("DOMNodeRemoved",a.removeHandler),a.target.removeEventListener("DOMAttrModified",a.attributeHandler)}),this.elements=[],this}}),b.components=function(a){var c=a.attributes,d=c.length,e=[],f=c.is&&c.is.nodeValue||a.tagName.toLowerCase();u(f,b.types.TAG)&&e.push(I[f]);for(var g=0;d>g;g++){var h=c[g].nodeName;u(h,b.types.ATTR)&&e.push(I[h])}for(var i=m(a),j=i.length,k=0;j>k;k++){var l=i[k];u(l,b.types.CLASS)&&e.push(I[l])}return e},b.destroy=function(){return D&&(D.disconnect(),D=void 0),I={},b},b.init=function(a){return a.hasAttribute(F)?a:(j(a,"initialised")||(b.components(a).forEach(function(b){c(a,b)}),k(a,"initialised",!0)),y(a.childNodes),a)},b.template={},b.template.html=function(a){var b=w(a),c=new K(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.target.children.length||(c.target.innerHTML=j(c.target,"default-content"))}});return function(a){var d=w(a.innerHTML),e=b.cloneNode(!0),f=e.querySelectorAll("["+E+"]"),g=f&&f.length;if(g)for(var h=0;h<f.length;h++){var i=f[h],j=v(d,i.getAttribute(E));k(i,"default-content",i.innerHTML),j&&j.length&&(i.innerHTML="",x(i,j)),c.observe(i,{childList:!0})}a.innerHTML="",a.appendChild(e)}},b.types={ANY:"act",ATTR:"a",CLASS:"c",NOATTR:"ct",NOCLASS:"at",NOTAG:"ac",TAG:"t"},b.unregister=function(a){return delete I[a],b},b.version="0.9.0",b.defaults={attributes:!1,classname:"__skate",events:!1,id:"",prototype:{},template:!1,type:b.types.ANY};var L=C(function(){if(H){var a=document.getElementsByTagName("html")[0].childNodes;a&&y(a)}});document.getElementsByTagName("head")[0].appendChild(G),window.skate=b,"function"==typeof define&&define.amd?define(function(){return b}):"object"==typeof exports&&(module.exports=b)}();